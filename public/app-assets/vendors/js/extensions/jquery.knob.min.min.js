!function(a){"object"==typeof exports?module.exports=a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(b){var a={},d=Math.max,c=Math.min;a.c={},a.c.d=b(document),a.c.t=function(e){return e.originalEvent.touches.length-1},a.o=function(){var e=this;this.o=null,this.$=null,this.i=null,this.g=null,this.v=null,this.cv=null,this.x=0,this.y=0,this.w=0,this.h=0,this.$c=null,this.c=null,this.t=0,this.isInit=!1,this.fgColor=null,this.pColor=null,this.dH=null,this.cH=null,this.eH=null,this.rH=null,this.scale=1,this.relative=!1,this.relativeWidth=!1,this.relativeHeight=!1,this.$div=null,this.run=function(){var f=function(j,g){var k;for(k in g){e.o[k]=g[k]}e._carve().init(),e._configure()._draw()};if(!this.$.data("kontroled")){if(this.$.data("kontroled",!0),this.extend(),this.o=b.extend({min:void 0!==this.$.data("min")?this.$.data("min"):0,max:void 0!==this.$.data("max")?this.$.data("max"):100,stopper:!0,readOnly:this.$.data("readonly")||"readonly"===this.$.attr("readonly"),cursor:this.$.data("cursor")===!0&&30||this.$.data("cursor")||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),0.01)||0.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:null==this.$.data("displayinput")||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:!1,step:this.$.data("step")||1,rotation:this.$.data("rotation"),rtl:!1,draw:null,change:null,cancel:null,release:null,format:function(g){return g},parse:function(g){return parseFloat(g)}},this.o),this.o.flip="anticlockwise"===this.o.rotation||"acw"===this.o.rotation,this.o.inputColor||(this.o.inputColor=this.o.fgColor),this.$.is("fieldset")?(this.v={},this.i=this.$.find("input"),this.i.each(function(g){var j=b(this);e.i[g]=j,e.v[g]=e.o.parse(j.val()),j.bind("change blur",function(){var h={};h[g]=j.val(),e.val(e._validate(h))})}),this.$.find("legend").remove()):(this.i=this.$,this.v=this.o.parse(this.$.val()),""===this.v&&(this.v=this.o.min),this.$.bind("change blur",function(){e.val(e._validate(e.o.parse(e.$.val())))})),!this.o.displayInput&&this.$.hide(),this.$c=b(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height}),this.$div=b('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>'),this.$.wrap(this.$div).before(this.$c),this.$div=this.$.parent(),"undefined"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.$c[0]),this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null,!this.c){throw {name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}}}return this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1),this.relativeWidth=this.o.width%1!==0&&this.o.width.indexOf("%"),this.relativeHeight=this.o.height%1!==0&&this.o.height.indexOf("%"),this.relative=this.relativeWidth||this.relativeHeight,this._carve(),this.v instanceof Object?(this.cv={},this.copy(this.v,this.cv)):this.cv=this.v,this.$.bind("configure",f).parent().bind("configure",f),this._listen()._configure()._xy().init(),this.isInit=!0,this.$.val(this.o.format(this.v)),this._draw(),this}},this._carve=function(){if(this.relative){var g=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),f=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(g,f)}else{this.w=this.o.width,this.h=this.o.height}return this.$div.css({width:this.w+"px",height:this.h+"px"}),this.$c.attr({width:this.w,height:this.h}),1!==this.scale&&(this.$c[0].width=this.$c[0].width*this.scale,this.$c[0].height=this.$c[0].height*this.scale,this.$c.width(this.w),this.$c.height(this.h)),this},this._draw=function(){var f=!0;e.g=e.c,e.clear(),e.dH&&(f=e.dH()),f!==!1&&e.draw()},this._touch=function(f){var g=function(j){var h=e.xy2val(j.originalEvent.touches[e.t].pageX,j.originalEvent.touches[e.t].pageY);h!=e.cv&&(e.cH&&e.cH(h)===!1||(e.change(e._validate(h)),e._draw()))};return this.t=a.c.t(f),g(f),a.c.d.bind("touchmove.k",g).bind("touchend.k",function(){a.c.d.unbind("touchmove.k touchend.k"),e.val(e.cv)}),this},this._mouse=function(f){var g=function(j){var h=e.xy2val(j.pageX,j.pageY);h!=e.cv&&(e.cH&&e.cH(h)===!1||(e.change(e._validate(h)),e._draw()))};return g(f),a.c.d.bind("mousemove.k",g).bind("keyup.k",function(h){if(27===h.keyCode){if(a.c.d.unbind("mouseup.k mousemove.k keyup.k"),e.eH&&e.eH()===!1){return}e.cancel()}}).bind("mouseup.k",function(h){a.c.d.unbind("mousemove.k mouseup.k keyup.k"),e.val(e.cv)}),this},this._xy=function(){var f=this.$c.offset();return this.x=f.left,this.y=f.top,this},this._listen=function(){return this.o.readOnly?this.$.attr("readonly","readonly"):(this.$c.bind("mousedown",function(f){f.preventDefault(),e._xy()._mouse(f)}).bind("touchstart",function(f){f.preventDefault(),e._xy()._touch(f)}),this.listen()),this.relative&&b(window).resize(function(){e._carve().init(),e._draw()}),this},this._configure=function(){return this.o.draw&&(this.dH=this.o.draw),this.o.change&&(this.cH=this.o.change),this.o.cancel&&(this.eH=this.o.cancel),this.o.release&&(this.rH=this.o.release),this.o.displayPrevious?(this.pColor=this.h2rgba(this.o.fgColor,"0.4"),this.fgColor=this.h2rgba(this.o.fgColor,"0.6")):this.fgColor=this.o.fgColor,this},this._clear=function(){this.$c[0].width=this.$c[0].width},this._validate=function(g){var f=~~((0>g?-0.5:0.5)+g/this.o.step)*this.o.step;return Math.round(100*f)/100},this.listen=function(){},this.extend=function(){},this.init=function(){},this.change=function(f){},this.val=function(f){},this.xy2val=function(g,f){},this.draw=function(){},this.clear=function(){this._clear()},this.h2rgba=function(g,f){var h;return g=g.substring(1,7),h=[parseInt(g.substring(0,2),16),parseInt(g.substring(2,4),16),parseInt(g.substring(4,6),16)],"rgba("+h[0]+","+h[1]+","+h[2]+","+f+")"},this.copy=function(g,f){for(var h in g){f[h]=g[h]}}},a.Dial=function(){a.o.call(this),this.startAngle=null,this.xy=null,this.radius=null,this.lineWidth=null,this.cursorExt=null,this.w2=null,this.PI2=2*Math.PI,this.extend=function(){this.o=b.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)},this.val=function(f,e){return null==f?this.v:(f=this.o.parse(f),void (e!==!1&&f!=this.v&&this.rH&&this.rH(f)===!1||(this.cv=this.o.stopper?d(c(f,this.o.max),this.o.min):f,this.v=this.cv,this.$.val(this.o.format(this.v)),this._draw())))},this.xy2val=function(g,f){var h,j;return h=Math.atan2(g-(this.x+this.w2),-(f-this.y-this.w2))-this.angleOffset,this.o.flip&&(h=this.angleArc-h-this.PI2),this.angleArc!=this.PI2&&0>h&&h>-0.5?h=0:0>h&&(h+=this.PI2),j=h*(this.o.max-this.o.min)/this.angleArc+this.o.min,this.o.stopper&&(j=d(c(j,this.o.max),this.o.min)),j},this.listen=function(){var h,k,q,g,m=this,j=function(o){o.preventDefault();var u=o.originalEvent,i=u.detail||u.wheelDeltaX,s=u.detail||u.wheelDeltaY,e=m._validate(m.o.parse(m.$.val()))+(i>0||s>0?m.o.step:0>i||0>s?-m.o.step:0);e=d(c(e,m.o.max),m.o.min),m.val(e,!1),m.rH&&(clearTimeout(h),h=setTimeout(function(){m.rH(e),h=null},100),k||(k=setTimeout(function(){h&&m.rH(e),k=null},200)))},f=1,p={37:-m.o.step,38:m.o.step,39:m.o.step,40:-m.o.step};this.$.bind("keydown",function(l){var o=l.keyCode;if(o>=96&&105>=o&&(o=l.keyCode=o-48),q=parseInt(String.fromCharCode(o)),isNaN(q)&&(13!==o&&8!==o&&9!==o&&189!==o&&(190!==o||m.$.val().match(/\./))&&l.preventDefault(),b.inArray(o,[37,38,39,40])>-1)){l.preventDefault();var n=m.o.parse(m.$.val())+p[o]*f;m.o.stopper&&(n=d(c(n,m.o.max),m.o.min)),m.change(m._validate(n)),m._draw(),g=window.setTimeout(function(){f*=2},30)}}).bind("keyup",function(e){isNaN(q)?g&&(window.clearTimeout(g),g=null,f=1,m.val(m.$.val())):m.$.val()>m.o.max&&m.$.val(m.o.max)||m.$.val()<m.o.min&&m.$.val(m.o.min)}),this.$c.bind("mousewheel DOMMouseScroll",j),this.$.bind("mousewheel DOMMouseScroll",j)},this.init=function(){(this.v<this.o.min||this.v>this.o.max)&&(this.v=this.o.min),this.$.val(this.v),this.w2=this.w/2,this.cursorExt=this.o.cursor/100,this.xy=this.w2*this.scale,this.lineWidth=this.xy*this.o.thickness,this.lineCap=this.o.lineCap,this.radius=this.xy-this.lineWidth/2,this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset),this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc),this.angleOffset=this.o.angleOffset*Math.PI/180,this.angleArc=this.o.angleArc*Math.PI/180,this.startAngle=1.5*Math.PI+this.angleOffset,this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var e=d(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/e>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})&&(this.o.rtl?this.i.css({"margin-right":"-"+(3*this.w/4+2>>0)+"px"}):this.i.css({"margin-left":"-"+(3*this.w/4+2>>0)+"px"}))||this.i.css({width:"0px",visibility:"hidden"})},this.change=function(e){this.cv=e,this.$.val(this.o.format(e))},this.angle=function(e){return(e-this.o.min)*this.angleArc/(this.o.max-this.o.min)},this.arc=function(f){var e,g;return f=this.angle(f),this.o.flip?(e=this.endAngle+0.00001,g=e-f-0.00001):(e=this.startAngle-0.00001,g=e+f+0.00001),this.o.cursor&&(e=g-this.cursorExt)&&(g+=this.cursorExt),{s:e,e:g,d:this.o.flip&&!this.o.cursor}},this.draw=function(){var f,e=this.g,j=this.arc(this.cv),g=1;e.lineWidth=this.lineWidth,e.lineCap=this.lineCap,"none"!==this.o.bgColor&&(e.beginPath(),e.strokeStyle=this.o.bgColor,e.arc(this.xy,this.xy,this.radius,this.endAngle-0.00001,this.startAngle+0.00001,!0),e.stroke()),this.o.displayPrevious&&(f=this.arc(this.v),e.beginPath(),e.strokeStyle=this.pColor,e.arc(this.xy,this.xy,this.radius,f.s,f.e,f.d),e.stroke(),g=this.cv==this.v),e.beginPath(),e.strokeStyle=g?this.o.fgColor:this.fgColor,e.arc(this.xy,this.xy,this.radius,j.s,j.e,j.d),e.stroke()},this.cancel=function(){this.val(this.v)}},b.fn.dial=b.fn.knob=function(e){return this.each(function(){var f=new a.Dial;f.o=e,f.$=b(this),f.run()}).parent()}});