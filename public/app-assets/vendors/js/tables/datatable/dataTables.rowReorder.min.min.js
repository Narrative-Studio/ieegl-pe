/*!
 RowReorder 1.2.3
 2015-2017 SpryMedia Ltd - datatables.net/license
*/
(function(a){"function"===typeof define&&define.amd?define(["jquery","datatables.net"],function(b){return a(b,window,document)}):"object"===typeof exports?module.exports=function(c,b){c||(c=window);if(!b||!b.fn.dataTable){b=require("datatables.net")(c,b).$}return a(b,c,c.document)}:a(jQuery,window,document)})(function(n,j,i,a){var e=n.fn.dataTable,c=function(h,d){if(!e.versionCheck||!e.versionCheck("1.10.8")){throw"DataTables RowReorder requires DataTables 1.10.8 or newer"}this.c=n.extend(!0,{},e.defaults.rowReorder,c.defaults,d);this.s={bodyTop:null,dt:new e.Api(h),getDataFn:e.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:e.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0,documentOuterHeight:0,domCloneOuterHeight:0};this.dom={clone:null,dtScroll:n("div.dataTables_scrollBody",this.s.dt.table().container())};var f=this.s.dt.settings()[0],g=f.rowreorder;if(g){return g}f.rowreorder=this;this._constructor()};n.extend(c.prototype,{_constructor:function(){var g=this,d=this.s.dt,f=n(d.table().node());"static"===f.css("position")&&f.css("position","relative");n(d.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(h){if(g.c.enable){var l=n(this).closest("tr"),k=d.row(l);if(k.any()){return g._emitEvent("pre-row-reorder",{node:k.node(),index:k.index()}),g._mouseDown(h,l),!1}}});d.on("destroy.rowReorder",function(){n(d.table().container()).off(".rowReorder");d.off(".rowReorder")})},_cachePositions:function(){var h=this.s.dt,d=n(h.table().node()).find("thead").outerHeight(),f=n.unique(h.rows({page:"current"}).nodes().toArray()),g=n.map(f,function(k){return n(k).position().top-d}),f=n.map(g,function(l,k){return g.length<k-1?(l+g[k+1])/2:(l+l+n(h.row(":last-child").node()).outerHeight())/2});this.s.middles=f;this.s.bodyTop=n(h.table().body()).offset().top;this.s.windowHeight=n(j).height();this.s.documentOuterHeight=n(i).outerHeight()},_clone:function(k){var d=n(this.s.dt.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(k.clone(!1)),f=k.outerWidth(),h=k.outerHeight(),g=k.children().map(function(){return n(this).width()});d.width(f).height(h).find("tr").children().each(function(l){this.style.width=g[l]+"px"});d.appendTo("body");this.dom.clone=d;this.s.domCloneOuterHeight=d.outerHeight()},_clonePosition:function(h){var d=this.s.start,f=this._eventToPage(h,"Y")-d.top,h=this._eventToPage(h,"X")-d.left,g=this.c.snapX,f=f+d.offsetTop,d=!0===g?d.offsetLeft:"number"===typeof g?d.offsetLeft+g:h+d.offsetLeft;0>f?f=0:f+this.s.domCloneOuterHeight>this.s.documentOuterHeight&&(f=this.s.documentOuterHeight-this.s.domCloneOuterHeight);this.dom.clone.css({top:f,left:d})},_emitEvent:function(f,d){this.s.dt.iterator("table",function(g){n(g.nTable).triggerHandler(f+".dt",d)})},_eventToPage:function(f,d){return -1!==f.type.indexOf("touch")?f.originalEvent.touches[0]["page"+d]:f["page"+d]},_mouseDown:function(l,d){var f=this,k=this.s.dt,h=this.s.start,g=d.offset();h.top=this._eventToPage(l,"Y");h.left=this._eventToPage(l,"X");h.offsetTop=g.top;h.offsetLeft=g.left;h.nodes=n.unique(k.rows({page:"current"}).nodes().toArray());this._cachePositions();this._clone(d);this._clonePosition(l);this.dom.target=d;d.addClass("dt-rowReorder-moving");n(i).on("mouseup.rowReorder touchend.rowReorder",function(m){f._mouseUp(m)}).on("mousemove.rowReorder touchmove.rowReorder",function(m){f._mouseMove(m)});n(j).width()===n(i).width()&&n(i.body).addClass("dt-rowReorder-noOverflow");k=this.dom.dtScroll;this.s.scroll={windowHeight:n(j).height(),windowWidth:n(j).width(),dtTop:k.length?k.offset().top:null,dtLeft:k.length?k.offset().left:null,dtHeight:k.length?k.outerHeight():null,dtWidth:k.length?k.outerWidth():null}},_mouseMove:function(q){this._clonePosition(q);for(var d=this._eventToPage(q,"Y")-this.s.bodyTop,h=this.s.middles,p=null,l=this.s.dt,k=l.table().body(),m=0,o=h.length;m<o;m++){if(d<h[m]){p=m;break}}null===p&&(p=h.length);if(null===this.s.lastInsert||this.s.lastInsert!==p){0===p?this.dom.target.prependTo(k):(d=n.unique(l.rows({page:"current"}).nodes().toArray()),p>this.s.lastInsert?this.dom.target.insertAfter(d[p-1]):this.dom.target.insertBefore(d[p])),this._cachePositions(),this.s.lastInsert=p}this._shiftScroll(q)},_mouseUp:function(){var E=this,F=this.s.dt,G,D,A=this.c.dataSrc;this.dom.clone.remove();this.dom.clone=null;this.dom.target.removeClass("dt-rowReorder-moving");n(i).off(".rowReorder");n(i.body).removeClass("dt-rowReorder-noOverflow");clearInterval(this.s.scrollInterval);this.s.scrollInterval=null;var z=this.s.start.nodes,C=n.unique(F.rows({page:"current"}).nodes().toArray()),y={},B=[],x=[],v=this.s.getDataFn,w=this.s.setDataFn;G=0;for(D=z.length;G<D;G++){if(z[G]!==C[G]){var u=F.row(C[G]).id(),H=F.row(C[G]).data(),t=F.row(z[G]).data();u&&(y[u]=v(t));B.push({node:C[G],oldData:v(H),newData:v(t),newPosition:G,oldPosition:n.inArray(C[G],z)});x.push(C[G])}}var g=[B,{dataSrc:A,nodes:x,values:y,triggerRow:F.row(this.dom.target)}];this._emitEvent("row-reorder",g);var d=function(){if(E.c.update){G=0;for(D=B.length;G<D;G++){var f=F.row(B[G].node).data();w(f,B[G].newData);F.columns().every(function(){this.dataSrc()===A&&F.cell(B[G].node,this.index()).invalidate("data")})}E._emitEvent("row-reordered",g);F.draw(!1)}};this.c.editor?(this.c.enable=!1,this.c.editor.edit(x,!1,n.extend({submit:"changed"},this.c.formOptions)).multiSet(A,y).one("submitUnsuccessful.rowReorder",function(){F.draw(!1)}).one("submitSuccess.rowReorder",function(){d()}).one("submitComplete",function(){E.c.enable=!0;E.c.editor.off(".rowReorder")}).submit()):d()},_shiftScroll:function(q){var g=this,k=this.s.scroll,o=!1,p=q.pageY-i.body.scrollTop,m,l;65>p?m=-5:p>k.windowHeight-65&&(m=5);null!==k.dtTop&&q.pageY<k.dtTop+65?l=-5:null!==k.dtTop&&q.pageY>k.dtTop+k.dtHeight-65&&(l=5);m||l?(k.windowVert=m,k.dtVert=l,o=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null);!this.s.scrollInterval&&o&&(this.s.scrollInterval=setInterval(function(){if(k.windowVert){i.body.scrollTop=i.body.scrollTop+k.windowVert}if(k.dtVert){var d=g.dom.dtScroll[0];if(k.dtVert){d.scrollTop=d.scrollTop+k.dtVert}}},20))}});c.defaults={dataSrc:0,editor:null,enable:!0,formOptions:{},selector:"td:first-child",snapX:!1,update:!0};var b=n.fn.dataTable.Api;b.register("rowReorder()",function(){return this});b.register("rowReorder.enable()",function(d){d===a&&(d=!0);return this.iterator("table",function(f){f.rowreorder&&(f.rowreorder.c.enable=d)})});b.register("rowReorder.disable()",function(){return this.iterator("table",function(d){d.rowreorder&&(d.rowreorder.c.enable=!1)})});c.version="1.2.3";n.fn.dataTable.RowReorder=c;n.fn.DataTable.RowReorder=c;n(i).on("init.dt.dtr",function(h,d){if("dt"===h.namespace){var f=d.oInit.rowReorder,g=e.defaults.rowReorder;if(f||g){g=n.extend({},f,g),!1!==f&&new c(d,g)}}});return c});