!function(ab,aa,Z){function Y(b,f){var e=aa(b);e.data(W,this),this._container=e,this.data=[],this.fields=[],this._editingRow=null,this._sortField=null,this._sortOrder=T,this._firstDisplayingPage=1,this._init(f),this.render()}var X="JSGrid",W=X,V="JSGridItem",U="JSGridEditRow",T="asc",S="desc",R="{first}",Q="{pages}",P="{prev}",O="{next}",N="{last}",M="{pageIndex}",K="{pageCount}",J="{itemCount}",I="javascript:void(0);",H=function(b,d){return aa.isFunction(b)?b.apply(d,aa.makeArray(arguments).slice(2)):b},G=function(b){var d=aa.Deferred();return b&&b.then?b.then(function(){d.resolve.apply(d,arguments)},function(){d.reject.apply(d,arguments)}):d.resolve(b),d.promise()},F={loadData:aa.noop,insertItem:aa.noop,updateItem:aa.noop,deleteItem:aa.noop};Y.prototype={width:"auto",height:"auto",updateOnResize:!0,rowClass:aa.noop,rowRenderer:null,rowClick:function(b){this.editing&&this.editItem(aa(b.event.target).closest("tr"))},rowDoubleClick:aa.noop,noDataContent:"Not found",noDataRowClass:"jsgrid-nodata-row",heading:!0,headerRowRenderer:null,headerRowClass:"jsgrid-header-row",headerCellClass:"jsgrid-header-cell",filtering:!1,filterRowRenderer:null,filterRowClass:"jsgrid-filter-row",inserting:!1,insertRowRenderer:null,insertRowClass:"jsgrid-insert-row",editing:!1,editRowRenderer:null,editRowClass:"jsgrid-edit-row",confirmDeleting:!0,deleteConfirm:"Are you sure?",selecting:!0,selectedRowClass:"jsgrid-selected-row",oddRowClass:"jsgrid-row",evenRowClass:"jsgrid-alt-row",cellClass:"jsgrid-cell",sorting:!1,sortableClass:"jsgrid-header-sortable",sortAscClass:"jsgrid-header-sort jsgrid-header-sort-asc",sortDescClass:"jsgrid-header-sort jsgrid-header-sort-desc",paging:!1,pagerContainer:null,pageIndex:1,pageSize:20,pageButtonCount:15,pagerFormat:"Pages: {first} {prev} {pages} {next} {last} &nbsp;&nbsp; {pageIndex} of {pageCount}",pagePrevText:"Prev",pageNextText:"Next",pageFirstText:"First",pageLastText:"Last",pageNavigatorNextText:"...",pageNavigatorPrevText:"...",pagerContainerClass:"jsgrid-pager-container",pagerClass:"jsgrid-pager",pagerNavButtonClass:"jsgrid-pager-nav-button",pagerNavButtonInactiveClass:"jsgrid-pager-nav-inactive-button",pageClass:"jsgrid-pager-page",currentPageClass:"jsgrid-pager-current-page",customLoading:!1,pageLoading:!1,autoload:!1,controller:F,loadIndication:!0,loadIndicationDelay:500,loadMessage:"Please, wait...",loadShading:!0,invalidMessage:"Invalid data entered!",invalidNotify:function(b){var a=aa.map(b.errors,function(c){return c.message||null});ab.alert([this.invalidMessage].concat(a).join("\n"))},onInit:aa.noop,onRefreshing:aa.noop,onRefreshed:aa.noop,onPageChanged:aa.noop,onItemDeleting:aa.noop,onItemDeleted:aa.noop,onItemInserting:aa.noop,onItemInserted:aa.noop,onItemEditing:aa.noop,onItemUpdating:aa.noop,onItemUpdated:aa.noop,onItemInvalid:aa.noop,onDataLoading:aa.noop,onDataLoaded:aa.noop,onOptionChanging:aa.noop,onOptionChanged:aa.noop,onError:aa.noop,invalidClass:"jsgrid-invalid",containerClass:"jsgrid",tableClass:"jsgrid-table",gridHeaderClass:"jsgrid-grid-header",gridBodyClass:"jsgrid-grid-body",_init:function(b){aa.extend(this,b),this._initLoadStrategy(),this._initController(),this._initFields(),this._attachWindowLoadResize(),this._attachWindowResizeCallback(),this._callEventHandler(this.onInit)},loadStrategy:function(){return this.pageLoading?new jsGrid.loadStrategies.PageLoadingStrategy(this):new jsGrid.loadStrategies.DirectLoadingStrategy(this)},_initLoadStrategy:function(){this._loadStrategy=H(this.loadStrategy,this)},_initController:function(){this._controller=aa.extend({},F,H(this.controller,this))},renderTemplate:function(f,c,h){args=[];for(var g in h){args.push(h[g])}return args.unshift(f,c),f=H.apply(null,args),f===Z||null===f?"":f},loadIndicator:function(b){return new jsGrid.LoadIndicator(b)},validation:function(b){return jsGrid.Validation&&new jsGrid.Validation(b)},_initFields:function(){var b=this;b.fields=aa.map(b.fields,function(e){if(aa.isPlainObject(e)){var a=e.type&&jsGrid.fields[e.type]||jsGrid.Field;e=new a(e)}return e._grid=b,e})},_attachWindowLoadResize:function(){aa(ab).on("load",aa.proxy(this._refreshSize,this))},_attachWindowResizeCallback:function(){this.updateOnResize&&aa(ab).on("resize",aa.proxy(this._refreshSize,this))},_detachWindowResizeCallback:function(){aa(ab).off("resize",this._refreshSize)},option:function(f,e){var h,g;return 1===arguments.length?this[f]:(h={option:f,oldValue:this[f],newValue:e},this._callEventHandler(this.onOptionChanging,h),this._handleOptionChange(h.option,h.newValue),g={option:h.option,value:h.newValue},void this._callEventHandler(this.onOptionChanged,g))},fieldOption:function(e,d,f){return e=this._normalizeField(e),2===arguments.length?e[d]:(e[d]=f,void this._renderGrid())},_handleOptionChange:function(d,c){switch(this[d]=c,d){case"width":case"height":this._refreshSize();break;case"rowClass":case"rowRenderer":case"rowClick":case"rowDoubleClick":case"noDataRowClass":case"noDataContent":case"selecting":case"selectedRowClass":case"oddRowClass":case"evenRowClass":this._refreshContent();break;case"pageButtonCount":case"pagerFormat":case"pagePrevText":case"pageNextText":case"pageFirstText":case"pageLastText":case"pageNavigatorNextText":case"pageNavigatorPrevText":case"pagerClass":case"pagerNavButtonClass":case"pageClass":case"currentPageClass":case"pagerRenderer":this._refreshPager();break;case"fields":this._initFields(),this.render();break;case"data":case"editing":case"heading":case"filtering":case"inserting":case"paging":this.refresh();break;case"loadStrategy":case"pageLoading":this._initLoadStrategy(),this.search();break;case"pageIndex":this.openPage(c);break;case"pageSize":this.refresh(),this.search();break;case"editRowRenderer":case"editRowClass":this.cancelEdit();break;case"updateOnResize":this._detachWindowResizeCallback(),this._attachWindowResizeCallback();break;case"invalidNotify":case"invalidMessage":break;default:this.render()}},destroy:function(){this._detachWindowResizeCallback(),this._clear(),this._container.removeData(W)},render:function(){return this._renderGrid(),this.autoload?this.loadData():aa.Deferred().resolve().promise()},_renderGrid:function(){this._clear(),this._container.addClass(this.containerClass).css("position","relative").append(this._createHeader()).append(this._createBody()),this._pagerContainer=this._createPagerContainer(),this._loadIndicator=this._createLoadIndicator(),this._validation=this._createValidation(),this.refresh()},_createLoadIndicator:function(){return H(this.loadIndicator,this,{message:this.loadMessage,shading:this.loadShading,container:this._container})},_createValidation:function(){return H(this.validation,this)},_clear:function(){this.cancelEdit(),clearTimeout(this._loadingTimer),this._pagerContainer&&this._pagerContainer.empty(),this._container.empty().css({position:"",width:"",height:""})},_createHeader:function(){var b=this._headerRow=this._createHeaderRow(),j=this._filterRow=this._createFilterRow(),i=this._insertRow=this._createInsertRow(),h=this._headerGrid=aa("<table>").addClass(this.tableClass).append(b).append(j).append(i),g=this._header=aa("<div>").addClass(this.gridHeaderClass).addClass(this._scrollBarWidth()?"jsgrid-header-scrollbar":"").append(h);return g},_createBody:function(){var b=this._content=aa("<tbody>"),f=this._bodyGrid=aa("<table>").addClass(this.tableClass).append(b),e=this._body=aa("<div>").addClass(this.gridBodyClass).append(f).on("scroll",aa.proxy(function(c){this._header.scrollLeft(c.target.scrollLeft)},this));return e},_createPagerContainer:function(){var b=this.pagerContainer||aa("<div>").appendTo(this._container);return aa(b).addClass(this.pagerContainerClass)},_eachField:function(b){var d=this;aa.each(this.fields,function(a,c){c.visible&&b.call(d,c,a)})},_createHeaderRow:function(){if(aa.isFunction(this.headerRowRenderer)){return aa(this.renderTemplate(this.headerRowRenderer,this))}var b=aa("<tr>").addClass(this.headerRowClass);return this._eachField(function(g,f){var a=this._prepareCell("<th>",g,"headercss",this.headerCellClass).append(this.renderTemplate(g.headerTemplate,g)).appendTo(b);this.sorting&&g.sorting&&a.addClass(this.sortableClass).on("click",aa.proxy(function(){this.sort(f)},this))}),b},_prepareCell:function(b,h,g,f){return aa(b).css("width",h.width).addClass(f||this.cellClass).addClass(g&&h[g]||h.css).addClass(h.align?"jsgrid-align-"+h.align:"")},_createFilterRow:function(){if(aa.isFunction(this.filterRowRenderer)){return aa(this.renderTemplate(this.filterRowRenderer,this))}var b=aa("<tr>").addClass(this.filterRowClass);return this._eachField(function(a){this._prepareCell("<td>",a,"filtercss").append(this.renderTemplate(a.filterTemplate,a)).appendTo(b)}),b},_createInsertRow:function(){if(aa.isFunction(this.insertRowRenderer)){return aa(this.renderTemplate(this.insertRowRenderer,this))}var b=aa("<tr>").addClass(this.insertRowClass);return this._eachField(function(a){this._prepareCell("<td>",a,"insertcss").append(this.renderTemplate(a.insertTemplate,a)).appendTo(b)}),b},_callEventHandler:function(b,d){return b.call(this,aa.extend(d,{grid:this})),d},reset:function(){return this._resetSorting(),this._resetPager(),this._loadStrategy.reset()},_resetPager:function(){this._firstDisplayingPage=1,this._setPage(1)},_resetSorting:function(){this._sortField=null,this._sortOrder=T,this._clearSortingCss()},refresh:function(){this._callEventHandler(this.onRefreshing),this.cancelEdit(),this._refreshHeading(),this._refreshFiltering(),this._refreshInserting(),this._refreshContent(),this._refreshPager(),this._refreshSize(),this._callEventHandler(this.onRefreshed)},_refreshHeading:function(){this._headerRow.toggle(this.heading)},_refreshFiltering:function(){this._filterRow.toggle(this.filtering)},_refreshInserting:function(){this._insertRow.toggle(this.inserting)},_refreshContent:function(){var g=this._content;if(g.empty(),!this.data.length){return g.append(this._createNoDataRow()),this}for(var f=this._loadStrategy.firstDisplayIndex(),j=this._loadStrategy.lastDisplayIndex(),i=f;j>i;i++){var h=this.data[i];g.append(this._createRow(h,i))}},_createNoDataRow:function(){var b=0;return this._eachField(function(){b++}),aa("<tr>").addClass(this.noDataRowClass).append(aa("<td>").attr("colspan",b).append(this.renderTemplate(this.noDataContent,this)))},_createRow:function(b,f){var e;return aa.isFunction(this.rowRenderer)?e=this.renderTemplate(this.rowRenderer,this,{item:b,itemIndex:f}):(e=aa("<tr>"),this._renderCells(e,b)),e.addClass(this._getRowClasses(b,f)).data(V,b).on("click",aa.proxy(function(a){this.rowClick({item:b,itemIndex:f,event:a})},this)).on("dblclick",aa.proxy(function(a){this.rowDoubleClick({item:b,itemIndex:f,event:a})},this)),this.selecting&&this._attachRowHover(e),e},_getRowClasses:function(e,d){var f=[];return f.push((d+1)%2?this.oddRowClass:this.evenRowClass),f.push(H(this.rowClass,this,e,d)),f.join(" ")},_attachRowHover:function(b){var d=this.selectedRowClass;b.hover(function(){aa(this).addClass(d)},function(){aa(this).removeClass(d)})},_renderCells:function(d,c){return this._eachField(function(a){d.append(this._createCell(c,a))}),this},_createCell:function(b,j){var i,h=this._getItemFieldValue(b,j),g={value:h,item:b};return i=aa.isFunction(j.cellRenderer)?this.renderTemplate(j.cellRenderer,j,g):aa("<td>").append(this.renderTemplate(j.itemTemplate||h,j,g)),this._prepareCell(i,j)},_getItemFieldValue:function(f,e){for(var h=e.name.split("."),g=f[h.shift()];g&&h.length;){g=g[h.shift()]}return g},_setItemFieldValue:function(h,g,l){for(var k=g.name.split("."),j=h,i=k[0];j&&k.length;){h=j,i=k.shift(),j=h[i]}if(!j){for(;k.length;){h=h[i]={},i=k.shift()}}h[i]=l},sort:function(b,d){return aa.isPlainObject(b)&&(d=b.order,b=b.field),this._clearSortingCss(),this._setSortingParams(b,d),this._setSortingCss(),this._loadStrategy.sort()},_clearSortingCss:function(){this._headerRow.find("th").removeClass(this.sortAscClass).removeClass(this.sortDescClass)},_setSortingParams:function(d,c){d=this._normalizeField(d),c=c||(this._sortField===d?this._reversedSortOrder(this._sortOrder):T),this._sortField=d,this._sortOrder=c},_normalizeField:function(b){return aa.isNumeric(b)?this.fields[b]:"string"==typeof b?aa.grep(this.fields,function(a){return a.name===b})[0]:b},_reversedSortOrder:function(b){return b===T?S:T},_setSortingCss:function(){var b=this._visibleFieldIndex(this._sortField);this._headerRow.find("th").eq(b).addClass(this._sortOrder===T?this.sortAscClass:this.sortDescClass)},_visibleFieldIndex:function(b){return aa.inArray(b,aa.grep(this.fields,function(c){return c.visible}))},_sortData:function(){var d=this._sortFactor(),c=this._sortField;c&&this.data.sort(function(b,a){return d*c.sortingFunc(b[c.name],a[c.name])})},_sortFactor:function(){return this._sortOrder===T?1:-1},_itemsCount:function(){return this._loadStrategy.itemsCount()},_pagesCount:function(){var d=this._itemsCount(),c=this.pageSize;return Math.floor(d/c)+(d%c?1:0)},_refreshPager:function(){var d=this._pagerContainer;d.empty(),this.paging&&d.append(this._createPager());var c=this.paging&&this._pagesCount()>1;d.toggle(c)},_createPager:function(){var b;return b=aa.isFunction(this.pagerRenderer)?aa(this.pagerRenderer({pageIndex:this.pageIndex,pageCount:this._pagesCount()})):aa("<div>").append(this._createPagerByFormat()),b.addClass(this.pagerClass),b},_createPagerByFormat:function(){var b=this.pageIndex,h=this._pagesCount(),g=this._itemsCount(),f=this.pagerFormat.split(" ");return aa.map(f,aa.proxy(function(c){var a=c;return c===Q?a=this._createPages():c===R?a=this._createPagerNavButton(this.pageFirstText,1,b>1):c===P?a=this._createPagerNavButton(this.pagePrevText,b-1,b>1):c===O?a=this._createPagerNavButton(this.pageNextText,b+1,h>b):c===N?a=this._createPagerNavButton(this.pageLastText,h,h>b):c===M?a=b:c===K?a=h:c===J&&(a=g),aa.isArray(a)?a.concat([" "]):[a," "]},this))},_createPages:function(){var h=this._pagesCount(),g=this.pageButtonCount,l=this._firstDisplayingPage,k=[];l>1&&k.push(this._createPagerPageNavButton(this.pageNavigatorPrevText,this.showPrevPages));for(var j=0,i=l;g>j&&h>=i;j++,i++){k.push(i===this.pageIndex?this._createPagerCurrentPage():this._createPagerPage(i))}return h>l+g-1&&k.push(this._createPagerPageNavButton(this.pageNavigatorNextText,this.showNextPages)),k},_createPagerNavButton:function(b,f,e){return this._createPagerButton(b,this.pagerNavButtonClass+(e?"":" "+this.pagerNavButtonInactiveClass),e?function(){this.openPage(f)}:aa.noop)},_createPagerPageNavButton:function(d,c){return this._createPagerButton(d,this.pagerNavButtonClass,c)},_createPagerPage:function(b){return this._createPagerButton(b,this.pageClass,function(){this.openPage(b)})},_createPagerButton:function(b,h,g){var f=aa("<a>").attr("href",I).html(b).on("click",aa.proxy(g,this));return aa("<span>").addClass(h).append(f)},_createPagerCurrentPage:function(){return aa("<span>").addClass(this.pageClass).addClass(this.currentPageClass).text(this.pageIndex)},_refreshSize:function(){this._refreshHeight(),this._refreshWidth()},_refreshWidth:function(){var e=this._headerGrid,d=this._bodyGrid,f=this.width;"auto"===f&&(e.width("auto"),f=e.outerWidth()),e.width(""),d.width(""),this._container.width(f),f=e.outerWidth(),d.width(f)},_scrollBarWidth:function(){var b;return function(){if(b===Z){var i=aa("<div style='width:50px;height:50px;overflow:hidden;position:absolute;top:-10000px;left:-10000px;'></div>"),h=aa("<div style='height:100px;'></div>");i.append(h).appendTo("body");var c=h.innerWidth();i.css("overflow-y","auto");var a=h.innerWidth();i.remove(),b=c-a}return b}}(),_refreshHeight:function(){var f,e=this._container,h=this._pagerContainer,g=this.height;e.height(g),"auto"!==g&&(g=e.height(),f=this._header.outerHeight(!0),h.parents(e).length&&(f+=h.outerHeight(!0)),this._body.outerHeight(g-f))},showPrevPages:function(){var d=this._firstDisplayingPage,c=this.pageButtonCount;this._firstDisplayingPage=d>c?d-c:1,this._refreshPager()},showNextPages:function(){var e=this._firstDisplayingPage,d=this.pageButtonCount,f=this._pagesCount();this._firstDisplayingPage=e+2*d>f?f-d+1:e+d,this._refreshPager()},openPage:function(b){1>b||b>this._pagesCount()||(this._setPage(b),this._loadStrategy.openPage(b))},_setPage:function(e){var d=this._firstDisplayingPage,f=this.pageButtonCount;this.pageIndex=e,d>e&&(this._firstDisplayingPage=e),e>d+f-1&&(this._firstDisplayingPage=e-f+1),this._callEventHandler(this.onPageChanged,{pageIndex:e})},_controllerCall:function(b,j,i,h){if(i){return aa.Deferred().reject().promise()}this._showLoading();var g=this._controller;if(!g||!g[b]){throw Error("controller has no method '"+b+"'")}return G(g[b](j)).done(aa.proxy(h,this)).fail(aa.proxy(this._errorHandler,this)).always(aa.proxy(this._hideLoading,this))},_errorHandler:function(){this._callEventHandler(this.onError,{args:aa.makeArray(arguments)})},_showLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadingTimer=setTimeout(aa.proxy(function(){this._loadIndicator.show()},this),this.loadIndicationDelay))},_hideLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadIndicator.hide())},search:function(b){return this._resetSorting(),this._resetPager(),this.loadData(b)},loadData:function(b){b=b||(this.filtering?this.getFilter():{}),aa.extend(b,this._loadStrategy.loadParams(),this._sortingParams());var d=this._callEventHandler(this.onDataLoading,{filter:b});return this._controllerCall("loadData",b,d.cancel,function(c){c&&(this._loadStrategy.finishLoad(c),this._callEventHandler(this.onDataLoaded,{data:c}))})},getFilter:function(){var b={};return this._eachField(function(a){a.filtering&&this._setItemFieldValue(b,a,a.filterValue())}),b},_sortingParams:function(){return this.sorting&&this._sortField?{sortField:this._sortField.name,sortOrder:this._sortOrder}:{}},getSorting:function(){var b=this._sortingParams();return{field:b.sortField,order:b.sortOrder}},clearFilter:function(){var b=this._createFilterRow();return this._filterRow.replaceWith(b),this._filterRow=b,this.search()},insertItem:function(b){var f=b||this._getValidatedInsertItem();if(!f){return aa.Deferred().reject().promise()}var e=this._callEventHandler(this.onItemInserting,{item:f});return this._controllerCall("insertItem",f,e.cancel,function(c){c=c||f,this._loadStrategy.finishInsert(c),this._callEventHandler(this.onItemInserted,{item:c})})},_getValidatedInsertItem:function(){var b=this._getInsertItem();return this._validateItem(b,this._insertRow)?b:null},_getInsertItem:function(){var b={};return this._eachField(function(a){a.inserting&&this._setItemFieldValue(b,a,a.insertValue())}),b},_validateItem:function(b,j){var i=[],h={item:b,itemIndex:this._rowIndex(j),row:j};if(this._eachField(function(e){if(e.validate){var d=this._getItemFieldValue(b,e);if(d!==Z){var a=this._validation.validate(aa.extend({value:d,rules:e.validate},h));this._setCellValidity(j.children().eq(this._visibleFieldIndex(e)),a),a.length&&i.push.apply(i,aa.map(a,function(f){return{field:e,message:f}}))}}}),!i.length){return !0}var c=aa.extend({errors:i},h);return this._callEventHandler(this.onItemInvalid,c),this.invalidNotify(c),!1},_setCellValidity:function(d,c){d.toggleClass(this.invalidClass,!!c.length).attr("title",c.join("\n"))},clearInsert:function(){var b=this._createInsertRow();this._insertRow.replaceWith(b),this._insertRow=b,this.refresh()},editItem:function(d){var c=this.rowByItem(d);c.length&&this._editRow(c)},rowByItem:function(b){return b.jquery||b.nodeType?aa(b):this._content.find("tr").filter(function(){return aa.data(this,V)===b})},_editRow:function(f){if(this.editing){var e=f.data(V),h=this._callEventHandler(this.onItemEditing,{row:f,item:e,itemIndex:this._itemIndex(e)});if(!h.cancel){this._editingRow&&this.cancelEdit();var g=this._createEditRow(e);this._editingRow=f,f.hide(),g.insertBefore(f),f.data(U,g)}}},_createEditRow:function(b){if(aa.isFunction(this.editRowRenderer)){return aa(this.renderTemplate(field.editRowRenderer,field,{item:b,itemIndex:this._itemIndex(b)}))}var d=aa("<tr>").addClass(this.editRowClass);return this._eachField(function(a){var c=this._getItemFieldValue(b,a);this._prepareCell("<td>",a,"editcss").append(this.renderTemplate(a.editTemplate||"",a,{value:c,item:b})).appendTo(d)}),d},updateItem:function(e,d){1===arguments.length&&(d=e);var f=e?this.rowByItem(e):this._editingRow;return(d=d||this._getValidatedEditedItem())?this._updateRow(f,d):void 0},_getValidatedEditedItem:function(){var b=this._getEditedItem();return this._validateItem(b,this._getEditRow())?b:null},_updateRow:function(b,l){var k=b.data(V),j=this._itemIndex(k),i=aa.extend(!0,{},k);aa.extend(!0,k,l);var g=this._callEventHandler(this.onItemUpdating,{row:b,item:k,itemIndex:j,previousItem:i});return this._controllerCall("updateItem",k,g.cancel,function(a){a=a||k;var d=this._finishUpdate(b,a,j);this._callEventHandler(this.onItemUpdated,{row:d,item:a,itemIndex:j,previousItem:i})})},_rowIndex:function(b){return this._content.children().index(aa(b))},_itemIndex:function(b){return aa.inArray(b,this.data)},_finishUpdate:function(f,e,h){this.cancelEdit(),this.data[h]=e;var g=this._createRow(e,h);return f.replaceWith(g),g},_getEditedItem:function(){var b={};return this._eachField(function(a){a.editing&&this._setItemFieldValue(b,a,a.editValue())}),b},cancelEdit:function(){this._editingRow&&(this._getEditRow().remove(),this._editingRow.show(),this._editingRow=null)},_getEditRow:function(){return this._editingRow.data(U)},deleteItem:function(a){var d=this.rowByItem(a);if(d.length&&(!this.confirmDeleting||ab.confirm(H(this.deleteConfirm,this,d.data(V))))){return this._deleteRow(d)}},_deleteRow:function(f){var e=f.data(V),h=this._itemIndex(e),g=this._callEventHandler(this.onItemDeleting,{row:f,item:e,itemIndex:h});return this._controllerCall("deleteItem",e,g.cancel,function(){this._loadStrategy.finishDelete(e,h),this._callEventHandler(this.onItemDeleted,{row:f,item:e,itemIndex:h})})}},aa.fn.jsGrid=function(b){var f=aa.makeArray(arguments),d=f.slice(1),c=this;return this.each(function(){var h,g=aa(this),a=g.data(W);if(a){if("string"==typeof b){if(h=a[b].apply(a,d),h!==Z&&h!==a){return c=h,!1}}else{a._detachWindowResizeCallback(),a._init(b),a.render()}}else{new Y(g,b)}}),c};var E={},D=function(b){var d;aa.isPlainObject(b)?d=Y.prototype:(d=E[b].prototype,b=arguments[1]||{}),aa.extend(d,b)},C={},B=function(b){var d=aa.isPlainObject(b)?b:C[b];if(!d){throw Error("unknown locale "+b)}L(jsGrid,d)},L=function(b,d){aa.each(d,function(e,a){return aa.isPlainObject(a)?void L(b[e]||b[e[0].toUpperCase()+e.slice(1)],a):void (b.hasOwnProperty(e)?b[e]=a:b.prototype[e]=a)})};ab.jsGrid={Grid:Y,fields:E,setDefaults:D,locales:C,locale:B,version:"1.5.1"}}(window,jQuery),function(e,d){function f(b){this._init(b)}f.prototype={container:"body",message:"Loading...",shading:!0,zIndex:1000,shaderClass:"jsgrid-load-shader",loadPanelClass:"jsgrid-load-panel",_init:function(b){d.extend(!0,this,b),this._initContainer(),this._initShader(),this._initLoadPanel()},_initContainer:function(){this._container=d(this.container)},_initShader:function(){this.shading&&(this._shader=d("<div>").addClass(this.shaderClass).hide().css({position:"absolute",top:0,right:0,bottom:0,left:0,zIndex:this.zIndex}).appendTo(this._container))},_initLoadPanel:function(){this._loadPanel=d("<div>").addClass(this.loadPanelClass).text(this.message).hide().css({position:"absolute",top:"50%",left:"50%",zIndex:this.zIndex}).appendTo(this._container)},show:function(){var h=this._loadPanel.show(),g=h.outerWidth(),i=h.outerHeight();h.css({marginTop:-i/2,marginLeft:-g/2}),this._shader.show()},hide:function(){this._loadPanel.hide(),this._shader.hide()}},e.LoadIndicator=f}(jsGrid,jQuery),function(f,e){function h(b){this._grid=b}function g(b){this._grid=b,this._itemsCount=0}h.prototype={firstDisplayIndex:function(){var b=this._grid;return b.option("paging")?(b.option("pageIndex")-1)*b.option("pageSize"):0},lastDisplayIndex:function(){var d=this._grid,c=d.option("data").length;return d.option("paging")?Math.min(d.option("pageIndex")*d.option("pageSize"),c):c},itemsCount:function(){return this._grid.option("data").length},openPage:function(){this._grid.refresh()},loadParams:function(){return{}},sort:function(){return this._grid._sortData(),this._grid.refresh(),e.Deferred().resolve().promise()},reset:function(){return this._grid.refresh(),e.Deferred().resolve().promise()},finishLoad:function(b){this._grid.option("data",b)},finishInsert:function(d){var c=this._grid;c.option("data").push(d),c.refresh()},finishDelete:function(i,d){var j=this._grid;j.option("data").splice(d,1),j.reset()}},g.prototype={firstDisplayIndex:function(){return 0},lastDisplayIndex:function(){return this._grid.option("data").length},itemsCount:function(){return this._itemsCount},openPage:function(){this._grid.loadData()},loadParams:function(){var b=this._grid;return{pageIndex:b.option("pageIndex"),pageSize:b.option("pageSize")}},reset:function(){return this._grid.loadData()},sort:function(){return this._grid.loadData()},finishLoad:function(b){this._itemsCount=b.itemsCount,this._grid.option("data",b.data)},finishInsert:function(){this._grid.search()},finishDelete:function(){this._grid.search()}},f.loadStrategies={DirectLoadingStrategy:h,PageLoadingStrategy:g}}(jsGrid,jQuery),function(e){var d=function(b){return"undefined"!=typeof b&&null!==b},f={string:function(b,g){return d(b)||d(g)?d(b)?d(g)?(""+b).localeCompare(""+g):1:-1:0},number:function(g,c){return g-c},date:function(g,c){return g-c},numberAsString:function(g,c){return parseFloat(g)-parseFloat(c)}};e.sortStrategies=f}(jsGrid,jQuery),function(g,f,j){function i(b){this._init(b)}i.prototype={_init:function(b){f.extend(!0,this,b)},validate:function(b){var d=[];return f.each(this._normalizeRules(b.rules),function(k,c){if(!c.validator(b.value,b.item,c.param)){var a=f.isFunction(c.message)?c.message(b.value,b.item):c.message;d.push(a)}}),d},_normalizeRules:function(b){return f.isArray(b)||(b=[b]),f.map(b,f.proxy(function(c){return this._normalizeRule(c)},this))},_normalizeRule:function(b){if("string"==typeof b&&(b={validator:b}),f.isFunction(b)&&(b={validator:b}),!f.isPlainObject(b)){throw Error("wrong validation config specified")}return b=f.extend({},b),f.isFunction(b.validator)?b:this._applyNamedValidator(b,b.validator)},_applyNamedValidator:function(b,k){delete b.validator;var e=h[k];if(!e){throw Error('unknown validator "'+k+'"')}return f.isFunction(e)&&(e={validator:e}),f.extend({},e,b)}},g.Validation=i;var h={required:{message:"Field is required",validator:function(b){return b!==j&&null!==b&&""!==b}},rangeLength:{message:"Field value length is out of the defined range",validator:function(e,d,k){return e.length>=k[0]&&e.length<=k[1]}},minLength:{message:"Field value is too short",validator:function(e,d,k){return e.length>=k}},maxLength:{message:"Field value is too long",validator:function(e,d,k){return e.length<=k}},pattern:{message:"Field value is not matching the defined pattern",validator:function(e,d,k){return"string"==typeof k&&(k=new RegExp("^(?:"+k+")$")),k.test(e)}},range:{message:"Field value is out of the defined range",validator:function(e,d,k){return e>=k[0]&&e<=k[1]}},min:{message:"Field value is too small",validator:function(e,d,k){return e>=k}},max:{message:"Field value is too large",validator:function(e,d,k){return k>=e}}};g.validators=h}(jsGrid,jQuery),function(f,e,h){function g(b){e.extend(!0,this,b),this.sortingFunc=this._getSortingFunc()}g.prototype={name:"",title:null,css:"",align:"",width:100,visible:!0,filtering:!0,inserting:!0,editing:!0,sorting:!0,sorter:"string",headerTemplate:function(){return this.title===h||null===this.title?this.name:this.title},itemTemplate:function(b){return b},filterTemplate:function(){return""},insertTemplate:function(){return""},editTemplate:function(d,c){return this._value=d,this.itemTemplate(d,c)},filterValue:function(){return""},insertValue:function(){return""},editValue:function(){return this._value},_getSortingFunc:function(){var a=this.sorter;if(e.isFunction(a)){return a}if("string"==typeof a){return f.sortStrategies[a]}throw Error('wrong sorter for the field "'+this.name+'"!')}},f.Field=g}(jsGrid,jQuery),function(f,e){function h(b){g.call(this,b)}var g=f.Field;h.prototype=new g({autosearch:!0,readOnly:!1,filterTemplate:function(){if(!this.filtering){return""}var d=this._grid,c=this.filterControl=this._createTextBox();return this.autosearch&&c.on("keypress",function(a){13===a.which&&(d.search(),a.preventDefault())}),c},insertTemplate:function(){return this.inserting?this.insertControl=this._createTextBox():""},editTemplate:function(d){if(!this.editing){return this.itemTemplate(d)}var c=this.editControl=this._createTextBox();return c.val(d),c},filterValue:function(){return this.filterControl.val()},insertValue:function(){return this.insertControl.val()},editValue:function(){return this.editControl.val()},_createTextBox:function(){return e("<input>").attr("type","text").prop("readonly",!!this.readOnly)}}),f.fields.text=f.TextField=h}(jsGrid,jQuery),function(f,e){function h(b){g.call(this,b)}var g=f.TextField;h.prototype=new g({sorter:"number",align:"right",readOnly:!1,filterValue:function(){return parseInt(this.filterControl.val()||0,10)},insertValue:function(){return parseInt(this.insertControl.val()||0,10)},editValue:function(){return parseInt(this.editControl.val()||0,10)},_createTextBox:function(){return e("<input>").attr("type","number").prop("readonly",!!this.readOnly)}}),f.fields.number=f.NumberField=h}(jsGrid,jQuery),function(f,e){function h(b){g.call(this,b)}var g=f.TextField;h.prototype=new g({insertTemplate:function(){return this.inserting?this.insertControl=this._createTextArea():""},editTemplate:function(d){if(!this.editing){return this.itemTemplate(d)}var c=this.editControl=this._createTextArea();return c.val(d),c},_createTextArea:function(){return e("<textarea>").prop("readonly",!!this.readOnly)}}),f.fields.textarea=f.TextAreaField=h}(jsGrid,jQuery),function(i,h,n){function m(d){if(this.items=[],this.selectedIndex=-1,this.valueField="",this.textField="",d.valueField&&d.items.length){var c=d.items[0][d.valueField];this.valueType=typeof c===k?k:j}this.sorter=this.valueType,l.call(this,d)}var l=i.NumberField,k="number",j="string";m.prototype=new l({align:"center",valueType:k,itemTemplate:function(b){var r,q=this.items,p=this.valueField,o=this.textField;r=p?h.grep(q,function(a){return a[p]===b})[0]||{}:q[b];var c=o?r[o]:r;return c===n||null===c?"":c},filterTemplate:function(){if(!this.filtering){return""}var d=this._grid,c=this.filterControl=this._createSelect();return this.autosearch&&c.on("change",function(){d.search()}),c},insertTemplate:function(){return this.inserting?this.insertControl=this._createSelect():""},editTemplate:function(d){if(!this.editing){return this.itemTemplate(d)}var c=this.editControl=this._createSelect();return d!==n&&c.val(d),c},filterValue:function(){var b=this.filterControl.val();return this.valueType===k?parseInt(b||0,10):b},insertValue:function(){var b=this.insertControl.val();return this.valueType===k?parseInt(b||0,10):b},editValue:function(){var b=this.editControl.val();return this.valueType===k?parseInt(b||0,10):b},_createSelect:function(){var b=h("<select>"),o=this.valueField,g=this.textField,f=this.selectedIndex;return h.each(this.items,function(p,e){var d=o?e[o]:p,c=g?e[g]:e,a=h("<option>").attr("value",d).text(c).appendTo(b);a.prop("selected",f===p)}),b.prop("disabled",!!this.readOnly),b}}),i.fields.select=i.SelectField=m}(jsGrid,jQuery),function(g,f,j){function i(b){h.call(this,b)}var h=g.Field;i.prototype=new h({sorter:"number",align:"center",autosearch:!0,itemTemplate:function(b){return this._createCheckbox().prop({checked:b,disabled:!0})},filterTemplate:function(){if(!this.filtering){return""}var b=this._grid,d=this.filterControl=this._createCheckbox();return d.prop({readOnly:!0,indeterminate:!0}),d.on("click",function(){var c=f(this);c.prop("readOnly")?c.prop({checked:!1,readOnly:!1}):c.prop("checked")||c.prop({readOnly:!0,indeterminate:!0})}),this.autosearch&&d.on("click",function(){b.search()}),d},insertTemplate:function(){return this.inserting?this.insertControl=this._createCheckbox():""},editTemplate:function(d){if(!this.editing){return this.itemTemplate(d)}var c=this.editControl=this._createCheckbox();return c.prop("checked",d),c},filterValue:function(){return this.filterControl.get(0).indeterminate?j:this.filterControl.is(":checked")},insertValue:function(){return this.insertControl.is(":checked")},editValue:function(){return this.editControl.is(":checked")},_createCheckbox:function(){return f("<input>").attr("type","checkbox")}}),g.fields.checkbox=g.CheckboxField=i}(jsGrid,jQuery),function(f,e){function h(b){g.call(this,b),this._configInitialized=!1}var g=f.Field;h.prototype=new g({css:"jsgrid-control-field",align:"center",width:50,filtering:!1,inserting:!1,editing:!1,sorting:!1,buttonClass:"jsgrid-button",modeButtonClass:"jsgrid-mode-button",modeOnButtonClass:"jsgrid-mode-on-button",searchModeButtonClass:"jsgrid-search-mode-button",insertModeButtonClass:"jsgrid-insert-mode-button",editButtonClass:"jsgrid-edit-button",deleteButtonClass:"jsgrid-delete-button",searchButtonClass:"jsgrid-search-button",clearFilterButtonClass:"jsgrid-clear-filter-button",insertButtonClass:"jsgrid-insert-button",updateButtonClass:"jsgrid-update-button",cancelEditButtonClass:"jsgrid-cancel-edit-button",searchModeButtonTooltip:"Switch to searching",insertModeButtonTooltip:"Switch to inserting",editButtonTooltip:"Edit",deleteButtonTooltip:"Delete",searchButtonTooltip:"Search",clearFilterButtonTooltip:"Clear filter",insertButtonTooltip:"Insert",updateButtonTooltip:"Update",cancelEditButtonTooltip:"Cancel edit",editButton:!0,deleteButton:!0,clearFilterButton:!0,modeSwitchButton:!0,_initConfig:function(){this._hasFiltering=this._grid.filtering,this._hasInserting=this._grid.inserting,this._hasInserting&&this.modeSwitchButton&&(this._grid.inserting=!1),this._configInitialized=!0},headerTemplate:function(){this._configInitialized||this._initConfig();var d=this._hasFiltering,c=this._hasInserting;return this.modeSwitchButton&&(d||c)?d&&!c?this._createFilterSwitchButton():c&&!d?this._createInsertSwitchButton():this._createModeSwitchButton():""},itemTemplate:function(b,j){var i=e([]);return this.editButton&&(i=i.add(this._createEditButton(j))),this.deleteButton&&(i=i.add(this._createDeleteButton(j))),i},filterTemplate:function(){var b=this._createSearchButton();return this.clearFilterButton?b.add(this._createClearFilterButton()):b},insertTemplate:function(){return this._createInsertButton()},editTemplate:function(){return this._createUpdateButton().add(this._createCancelEditButton())},_createFilterSwitchButton:function(){return this._createOnOffSwitchButton("filtering",this.searchModeButtonClass,!0)},_createInsertSwitchButton:function(){return this._createOnOffSwitchButton("inserting",this.insertModeButtonClass,!1)},_createOnOffSwitchButton:function(b,m,l){var k=l,j=e.proxy(function(){i.toggleClass(this.modeOnButtonClass,k)},this),i=this._createGridButton(this.modeButtonClass+" "+m,"",function(a){k=!k,a.option(b,k),j()});return j(),i},_createModeSwitchButton:function(){var b=!1,j=e.proxy(function(){i.attr("title",b?this.searchModeButtonTooltip:this.insertModeButtonTooltip).toggleClass(this.insertModeButtonClass,!b).toggleClass(this.searchModeButtonClass,b)},this),i=this._createGridButton(this.modeButtonClass,"",function(a){b=!b,a.option("inserting",b),a.option("filtering",!b),j()});return j(),i},_createEditButton:function(b){return this._createGridButton(this.editButtonClass,this.editButtonTooltip,function(a,d){a.editItem(b),d.stopPropagation()})},_createDeleteButton:function(b){return this._createGridButton(this.deleteButtonClass,this.deleteButtonTooltip,function(a,d){a.deleteItem(b),d.stopPropagation()})},_createSearchButton:function(){return this._createGridButton(this.searchButtonClass,this.searchButtonTooltip,function(b){b.search()})},_createClearFilterButton:function(){return this._createGridButton(this.clearFilterButtonClass,this.clearFilterButtonTooltip,function(b){b.clearFilter()})},_createInsertButton:function(){return this._createGridButton(this.insertButtonClass,this.insertButtonTooltip,function(b){b.insertItem().done(function(){b.clearInsert()})})},_createUpdateButton:function(){return this._createGridButton(this.updateButtonClass,this.updateButtonTooltip,function(d,c){d.updateItem(),c.stopPropagation()})},_createCancelEditButton:function(){return this._createGridButton(this.cancelEditButtonClass,this.cancelEditButtonTooltip,function(d,c){d.cancelEdit(),c.stopPropagation()})},_createGridButton:function(b,k,j){var i=this._grid;return e("<input>").addClass(this.buttonClass).addClass(b).attr({type:"button",title:k}).on("click",function(c){j(i,c)})},editValue:function(){return""}}),f.fields.control=f.ControlField=h}(jsGrid,jQuery);